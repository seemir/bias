# Install relevant packages (if not already done)
# ----------------------------------------------------------- #
Packages <- c("NbClust", "xtable")
# install.packages(Packages)
# ----------------------------------------------------------- #
# Load relevant packages
# ----------------------------------------------------------- #
lapply(Packages, library, character.only = TRUE)
source("utilities.R")
# ----------------------------------------------------------- #
# Load pca objects and data files
# ----------------------------------------------------------- #
allDataFiles <- c("HFfullpca", "HFpEFpca", "HFmrEFpca",
"HFfullImp","HFpEFimp", "HFmrEFimp",
"SyndClass")
lapply(gsub(" ", "", paste("data_files/", allDataFiles,
".Rdat")), load,.GlobalEnv)
# ----------------------------------------------------------- #
# Determine optimal number of clusters
# ----------------------------------------------------------- #
NbClust(HFpEFpca$scores[,1:4], min.nc = 2, max.nc = 4,
method = "kmeans")
NbClust(HFmrEFpca$scores[,1:4], min.nc = 2, max.nc = 4,
method = "kmeans")
# ----------------------------------------------------------- #
# PCA cluster plot for all data sets
# ----------------------------------------------------------- #
path_to_images <- "../../../doc/thesis/images/"
pdf(file = paste(path_to_images, "ClustFull.pdf"))
clustFull <- pca.cluster.plot(HFfullpca, 4, km.clust = 2,
hc.clust = 2, em.clust = 2,
actual = SyndClass[,2],
return.clust = T, ellipse = F)
dev.off()
# ----------------------------------------------------------- #
# Extract cluster configuration and add to data frame
# ----------------------------------------------------------- #
ACTfull <- clustFull$ACT
HCfull <- clustFull$HC
KMfull <- clustFull$KM
EMfull <- clustFull$EM
# ----------------------------------------------------------- #
# Compare baseline characteristics
# ----------------------------------------------------------- #
act_full <- compare.baseline(cbind(HFfullImp, ACTfull),
"ACTfull")
act_hc <- compare.baseline(cbind(HFfullImp, HCfull),
"HCfull")
act_km <- compare.baseline(cbind(HFfullImp, KMfull),
"KMfull")
act_em <- compare.baseline(cbind(HFfullImp, EMfull),
"EMfull")
xtable(act_full[[2]][1:15,])
xtable(act_hc[[2]][1:15,])
xtable(act_km[[2]][1:15,])
xtable(act_em[[2]][1:15,])
# ----------------------------------------------------------- #
# Assuming clustering by physicians is correct
# ----------------------------------------------------------- #
pdf(file = paste(path_to_images, "ClustpBiPhy.pdf"))
clustPefFull <- pca.cluster.plot(HFpEFpca, 2, km.clust = 3,
hc.clust = 3, em.clust = 3,
return.clust = T, ellipse = F)
dev.off()
pdf(file = paste(path_to_images, "ClustmrBiPhy.pdf"))
clustMrFull <- pca.cluster.plot(HFmrEFpca, 2, km.clust = 3,
hc.clust = 3, em.clust = 3,
return.clust = T, ellipse = F)
dev.off()
# ----------------------------------------------------------- #
# Compare baseline characteristics HFpEF
# ----------------------------------------------------------- #
HCpEFphy <- clustPefFull$HC
KMpEFphy <- clustPefFull$KM
EMpEFphy <- clustPefFull$EM
post_HC_p <- compare.baseline(cbind(HFpEFimp, HCpEFphy),
"HCpEFphy")
post_KM_p <- compare.baseline(cbind(HFpEFimp, KMpEFphy),
"KMpEFphy")
post_EM_p <- compare.baseline(cbind(HFpEFimp, EMpEFphy),
"EMpEFphy")
xtable(post_HC_p[[2]][1:18,-1])
xtable(post_KM_p[[2]][1:18,-1])
xtable(post_EM_p[[2]][1:18,-1])
# ----------------------------------------------------------- #
# Compare baseline characteristics HFmrEF
# ----------------------------------------------------------- #
HCmrEFphy <- clustMrFull$HC
KMmrEFphy <- clustMrFull$KM
EMmrEFphy <- clustMrFull$EM
post_HC_mr <- compare.baseline(cbind(HFmrEFimp, HCmrEFphy),
"HCmrEFphy")
post_KM_mr <- compare.baseline(cbind(HFmrEFimp, KMmrEFphy),
"KMmrEFphy")
post_EM_mr <- compare.baseline(cbind(HFmrEFimp, EMmrEFphy),
"EMmrEFphy")
xtable(post_HC_mr[[2]][1:15,-1])
xtable(post_KM_mr[[2]][1:15,-1])
xtable(post_EM_mr[[2]][1:15,-1])
# ----------------------------------------------------------- #
# Assumin clustering by physicians is incorrect
# ----------------------------------------------------------- #
hiKmeansClust <- clustFull$HC
HFpEFhiKmeans <- HFfullImp[hiKmeansClust==1,]
HFmrEFhiKmeans <- HFfullImp[hiKmeansClust==2,]
# ----------------------------------------------------------- #
# Re-calculate principal components
# ----------------------------------------------------------- #
HFpEFNewpca <- princomp(HFpEFhiKmeans, cor = T)
HFmrEFNewpca <- princomp(HFmrEFhiKmeans, cor = T)
# ----------------------------------------------------------- #
# Plot clusters
# ----------------------------------------------------------- #
clustNewPef <- pca.cluster.plot(HFpEFNewpca, 2, km.clust = 3,
hc.clust = 3, em.clust = 3,
return.clust = T, ellipse = F)
clustNewMr <- pca.cluster.plot(HFmrEFNewpca, 2, km.clust = 3,
hc.clust = 3, em.clust = 3,
return.clust = T, ellipse = F)
# ----------------------------------------------------------- #
# Compare baseline characteristics HFpEF
# ----------------------------------------------------------- #
HCpEFnoPhy <- clustNewPef$HC
KMpEFnoPhy <- clustNewPef$KM
EMpEFnoPhy <- clustNewPef$EM
noPost_HC_p <-compare.baseline(cbind(HFpEFhiKmeans,
HCpEFnoPhy),"HCpEFnoPhy")
noPost_KM_p <-compare.baseline(cbind(HFpEFhiKmeans,
KMpEFnoPhy),"KMpEFnoPhy")
noPost_EM_p <-compare.baseline(cbind(HFpEFhiKmeans,
EMpEFnoPhy),"EMpEFnoPhy")
xtable(noPost_HC_p[[2]][1:15,-1])
xtable(noPost_KM_p[[2]][1:15,-1])
xtable(noPost_EM_p[[2]][1:15,-1])
# ----------------------------------------------------------- #
# Compare baseline characteristics HFmrEF
# ----------------------------------------------------------- #
HCmrEFnoPhy <- clustNewMr$HC
KMmrEFnoPhy <- clustNewMr$KM
EMmrEFnoPhy <- clustNewMr$EM
noPost_HC_mr<- compare.baseline(cbind(HFmrEFhiKmeans,
HCmrEFnoPhy),
"HCmrEFnoPhy")
noPost_KM_mr<- compare.baseline(cbind(HFmrEFhiKmeans,
KMmrEFnoPhy),
"KMmrEFnoPhy")
noPost_EM_mr<- compare.baseline(cbind(HFmrEFhiKmeans,
EMmrEFnoPhy),
"EMmrEFnoPhy")
xtable(noPost_HC_mr[[2]][1:15,-1])
xtable(noPost_KM_mr[[2]][1:15,-1])
xtable(noPost_EM_mr[[2]][1:15,-1])
# ----------------------------------------------------------- #
# Result of all the significant baseline characteristics
# ----------------------------------------------------------- #
results_post <- c(post_HC_p[[1]], post_KM_p[[1]],
post_EM_p[[1]], post_HC_mr[[1]],
post_KM_mr[[1]], post_EM_mr[[1]])
results_no_post <- c(noPost_HC_p[[1]], noPost_KM_p[[1]],
noPost_EM_p[[1]], noPost_HC_mr[[1]],
noPost_KM_mr[[1]], noPost_EM_mr[[1]])
results <- cbind(matrix(results_post, 3),
matrix(results_no_post, 3))
colnames(results) <- rep(c("HFpEF", "HFmrEF"), 2)
rownames(results) <- c("Hierarchical", "K-Means", "EM")
xtable(results)
# ----------------------------------------------------------- #
xtable(noPost_HC_mr[[2]][1:15,-1])
xtable(noPost_KM_mr[[2]][1:15,-1])
xtable(noPost_EM_mr[[2]][1:15,-1])
# ----------------------------------------------------------- #
# Install relevant packages (if not already done)
# ----------------------------------------------------------- #
Packages <- c("mlbench", "caret", "elasticnet", "klarR")
# install.packages(Packages)
# ----------------------------------------------------------- #
# Load relevant packages
# ----------------------------------------------------------- #
lapply(Packages, library, character.only = TRUE)
source("utilities.R")
# ----------------------------------------------------------- #
# Load data files
# ----------------------------------------------------------- #
allDataFiles <- c("HFfullImp", "HFfullOutcomes")
lapply(gsub(" ", "", paste("data_files/", allDataFiles,
".Rdat")), load,.GlobalEnv)
# ----------------------------------------------------------- #
# Add cross validation configuration
# ----------------------------------------------------------- #
kfold <- trainControl(method = "cv", number = 5)
seed <- 902109
metric <- "Accuracy"
# ----------------------------------------------------------- #
# Install relevant packages (if not already done)
# ----------------------------------------------------------- #
Packages <- c("mlbench", "caret", "elasticnet", "klarR")
# install.packages(Packages)
# ----------------------------------------------------------- #
# Load relevant packages
# ----------------------------------------------------------- #
lapply(Packages, library, character.only = TRUE)
source("utilities.R")
# ----------------------------------------------------------- #
# Load data files
# ----------------------------------------------------------- #
allDataFiles <- c("HFfullImp", "HFfullOutcomes")
lapply(gsub(" ", "", paste("data_files/", allDataFiles,
".Rdat")), load,.GlobalEnv)
# ----------------------------------------------------------- #
# Add cross validation configuration
# ----------------------------------------------------------- #
kfold <- trainControl(method = "cv", number = 5)
seed <- 90210
metric <- "Accuracy"
# ----------------------------------------------------------- #
# Train and evaluate the classification algorithms with kfold
# ----------------------------------------------------------- #
dataset <- HFfullImp[,-1]
mortality <- HFfullOutcomes[,3]
readmission <- HFfullOutcomes[,4]
set.seed(seed)
fitKnnKfoldMort <- train(dataset, mortality, method="knn",
metric=metric, trControl=kfold)
set.seed(seed)
fitLLKfoldMort <- train(dataset, mortality, method = "glm",
metric=metric, trControl = kfold)
set.seed(seed)
fitLDAKfoldMort <- train(dataset, mortality, method = "lda",
metric = metric, trControl = kfold)
set.seed(seed)
fitNbKfoldMort <- train(dataset, mortality, method = "nb",
metric = metric, trControl = kfold)
Packages <- c("mlbench", "caret", "elasticnet", "klarR")
install.packages(Packages)
install.packages(Packages)
install.packages(Packages)
install.packages(Packages)
install.packages(Packages)
# ----------------------------------------------------------- #
# Install relevant packages (if not already done)
# ----------------------------------------------------------- #
Packages <- c("NbClust", "xtable")
# install.packages(Packages)
# ----------------------------------------------------------- #
# Load relevant packages
# ----------------------------------------------------------- #
lapply(Packages, library, character.only = TRUE)
source("utilities.R")
# ----------------------------------------------------------- #
# Load pca objects and data files
# ----------------------------------------------------------- #
allDataFiles <- c("HFfullpca", "HFpEFpca", "HFmrEFpca",
"HFfullImp","HFpEFimp", "HFmrEFimp",
"SyndClass")
lapply(gsub(" ", "", paste("data_files/", allDataFiles,
".Rdat")), load,.GlobalEnv)
# ----------------------------------------------------------- #
# Install relevant packages (if not already done)
# ----------------------------------------------------------- #
Packages <- c("mlbench", "caret", "elasticnet", "klarR")
# install.packages(Packages)
# ----------------------------------------------------------- #
# Load relevant packages
# ----------------------------------------------------------- #
lapply(Packages, library, character.only = TRUE)
source("utilities.R")
# ----------------------------------------------------------- #
# Load data files
# ----------------------------------------------------------- #
allDataFiles <- c("HFfullImp", "HFfullOutcomes")
lapply(gsub(" ", "", paste("data_files/", allDataFiles,
".Rdat")), load,.GlobalEnv)
# ----------------------------------------------------------- #
# Add cross validation configuration
# ----------------------------------------------------------- #
kfold <- trainControl(method = "cv", number = 5)
seed <- 902109
metric <- "Accuracy"
# ----------------------------------------------------------- #
# Train and evaluate the classification algorithms with kfold
# ----------------------------------------------------------- #
dataset <- HFfullImp[,-1]
mortality <- HFfullOutcomes[,3]
readmission <- HFfullOutcomes[,4]
# ----------------------------------------------------------- #
# Mortality
# ----------------------------------------------------------- #
# kfold CV evaluation of classifiers
# ----------------------------------------------------------- #
set.seed(seed)
fitKnnKfoldMort <- train(dataset, mortality, method="knn",
metric=metric, trControl=kfold)
set.seed(seed)
fitLLKfoldMort <- train(dataset, mortality, method = "glm",
metric=metric, trControl = kfold)
set.seed(seed)
fitLDAKfoldMort <- train(dataset, mortality, method = "lda",
metric = metric, trControl = kfold)
set.seed(seed)
fitNbKfoldMort <- train(dataset, mortality, method = "nb",
metric = metric, trControl = kfold)
set.seed(seed)
fitSvmKfoldMort <- train(dataset, mortality,method="svmRadial",
metric=metric, trControl=kfold)
set.seed(seed)
fitRfKfoldMort <- train(dataset, mortality, method="rf",
metric = metric, trControl = kfold)
# ----------------------------------------------------------- #
# Produce summary statistics and plots
# ----------------------------------------------------------- #
# Kfold CV
# ----------------------------------------------------------- #
resultsMortalityKfold <- resamples(list(knn = fitKnnKfoldMort,
logr = fitLLKfoldMort,
lda = fitLDAKfoldMort,
nb = fitNbKfoldMort,
svm = fitSvmKfoldMort,
rf = fitRfKfoldMort))
summary(resultsMortalityKfold); dotplot(resultsMortalityKfold)
# ----------------------------------------------------------- #
# Readmission
# ----------------------------------------------------------- #
# kfold CV evaluation of classifiers
# ----------------------------------------------------------- #
set.seed(seed)
fitKnnKfoldReadm <- train(dataset, readmission, method="knn",
metric=metric, trControl=kfold)
set.seed(seed)
fitLLKfoldReadm <- train(dataset, readmission, method = "glm",
metric=metric, trControl = kfold)
set.seed(seed)
fitLDAKfoldReadm <- train(dataset[,-19], readmission,
method = "lda", metric = metric,
trControl = kfold)
set.seed(seed)
fitNbKfoldReadm <- train(dataset, readmission, method = "nb",
metric = metric, trControl = kfold)
set.seed(seed)
fitSvmKfoldReadm <- train(dataset, readmission,
method="svmRadial", metric=metric,
trControl=kfold)
set.seed(seed)
fitRfKfoldReadm <- train(dataset, readmission, method="rf",
metric = metric, trControl = kfold)
# ----------------------------------------------------------- #
# Produce summary statistics and plots
# ----------------------------------------------------------- #
# Kfold CV
# ----------------------------------------------------------- #
resultsReadmKfold <- resamples(list(knn = fitKnnKfoldReadm,
lda = fitLDAKfoldReadm,
nb = fitNbKfoldReadm,
logr = fitLLKfoldReadm,
svm = fitSvmKfoldReadm,
rf = fitRfKfoldReadm))
summary(resultsReadmKfold); dotplot(resultsReadmKfold)
# ----------------------------------------------------------- #
# ----------------------------------------------------------- #
# Install relevant packages (if not already done)
# ----------------------------------------------------------- #
Packages <- c("mlbench", "caret", "elasticnet", "klarR")
# install.packages(Packages)
# ----------------------------------------------------------- #
# Load relevant packages
# ----------------------------------------------------------- #
lapply(Packages, library, character.only = TRUE)
source("utilities.R")
# ----------------------------------------------------------- #
# Load data files
# ----------------------------------------------------------- #
allDataFiles <- c("HFfullImp", "HFfullOutcomes")
lapply(gsub(" ", "", paste("data_files/", allDataFiles,
".Rdat")), load,.GlobalEnv)
kfold <- trainControl(method = "cv", number = 5)
seed <- 902109
metric <- "Accuracy"
install.packages(Packages)
install.packages(Packages)
lapply(Packages, library, character.only = TRUE)
source("utilities.R")
kfold <- trainControl(method = "cv", number = 5)
seed <- 902109
metric <- "Accuracy"
# ----------------------------------------------------------- #
# Train and evaluate the classification algorithms with kfold
# ----------------------------------------------------------- #
dataset <- HFfullImp[,-1]
mortality <- HFfullOutcomes[,3]
readmission <- HFfullOutcomes[,4]
kfold <- trainControl(method = "cv", number = 5)
?trainControl
??trainControl
Packages <- c("mlbench", "caret", "elasticnet", "klarR")
lapply(Packages, library, character.only = TRUE)
source("utilities.R")
Packages <- c("mlbench", "caret", "elasticnet", "klarR")
install.packages(Packages)
install.packages(Packages)
lapply(Packages, library, character.only = TRUE)
allDataFiles <- c("HFfullImp", "HFfullOutcomes")
lapply(gsub(" ", "", paste("data_files/", allDataFiles,
".Rdat")), load,.GlobalEnv)
kfold <- trainControl(method = "cv", number = 5)
seed <- 902109
metric <- "Accuracy"
dataset <- HFfullImp[,-1]
mortality <- HFfullOutcomes[,3]
readmission <- HFfullOutcomes[,4]
set.seed(seed)
fitKnnKfoldMort <- train(dataset, mortality, method="knn",
metric=metric, trControl=kfold)
set.seed(seed)
fitLLKfoldMort <- train(dataset, mortality, method = "glm",
metric=metric, trControl = kfold)
set.seed(seed)
fitLDAKfoldMort <- train(dataset, mortality, method = "lda",
metric = metric, trControl = kfold)
set.seed(seed)
fitNbKfoldMort <- train(dataset, mortality, method = "nb",
metric = metric, trControl = kfold)
resultsMortalityKfold <- resamples(list(knn = fitKnnKfoldMort,
logr = fitLLKfoldMort,
lda = fitLDAKfoldMort,
nb = fitNbKfoldMort,
svm = fitSvmKfoldMort,
rf = fitRfKfoldMort))
set.seed(seed)
fitKnnKfoldMort <- train(dataset, mortality, method="knn",
metric=metric, trControl=kfold)
set.seed(seed)
fitLLKfoldMort <- train(dataset, mortality, method = "glm",
metric=metric, trControl = kfold)
set.seed(seed)
fitLDAKfoldMort <- train(dataset, mortality, method = "lda",
metric = metric, trControl = kfold)
set.seed(seed)
fitNbKfoldMort <- train(dataset, mortality, method = "nb",
metric = metric, trControl = kfold)
set.seed(seed)
fitSvmKfoldMort <- train(dataset, mortality,method="svmRadial",
metric=metric, trControl=kfold)
set.seed(seed)
fitRfKfoldMort <- train(dataset, mortality, method="rf",
metric = metric, trControl = kfold)
# ----------------------------------------------------------- #
# Produce summary statistics and plots
# ----------------------------------------------------------- #
# Kfold CV
# ----------------------------------------------------------- #
resultsMortalityKfold <- resamples(list(knn = fitKnnKfoldMort,
logr = fitLLKfoldMort,
lda = fitLDAKfoldMort,
nb = fitNbKfoldMort,
svm = fitSvmKfoldMort,
rf = fitRfKfoldMort))
summary(resultsMortalityKfold); dotplot(resultsMortalityKfold)
summary(resultsMortalityKfold); dotplot(resultsMortalityKfold)
?dotplot
?dotplot
summary(resultsMortalityKfold); dotplot(resultsMortalityKfold, title = "Mortaility")
dotplot(resultsMortalityKfold, title = "Mortaility")
dotplot(resultsMortalityKfold, main = "Mortaility")
dotplot(resultsMortalityKfold, main = "Mortality")
tikzDevice::tikz("classification_mortality")
dotplot(resultsMortalityKfold, main = "Mortality")
tikzDevice::tikz("classification_mortality")
dotplot(resultsMortalityKfold, main = "Mortality")
dev.off()
tikzDevice::tikz("classification_mortality", width = 5, height = 5)
dotplot(resultsMortalityKfold, main = "Mortality")
dev.off()
tikzDevice::tikz("classification_mortality", width = 6, height = 5)
dotplot(resultsMortalityKfold, main = "Mortality")
dev.off()
set.seed(seed)
fitKnnKfoldReadm <- train(dataset, readmission, method="knn",
metric=metric, trControl=kfold)
set.seed(seed)
fitLLKfoldReadm <- train(dataset, readmission, method = "glm",
metric=metric, trControl = kfold)
set.seed(seed)
fitLDAKfoldReadm <- train(dataset[,-19], readmission,
method = "lda", metric = metric,
trControl = kfold)
set.seed(seed)
fitNbKfoldReadm <- train(dataset, readmission, method = "nb",
metric = metric, trControl = kfold)
set.seed(seed)
fitSvmKfoldReadm <- train(dataset, readmission,
method="svmRadial", metric=metric,
trControl=kfold)
set.seed(seed)
fitRfKfoldReadm <- train(dataset, readmission, method="rf",
metric = metric, trControl = kfold)
# ----------------------------------------------------------- #
# Produce summary statistics and plots
# ----------------------------------------------------------- #
# Kfold CV
# ----------------------------------------------------------- #
resultsReadmKfold <- resamples(list(knn = fitKnnKfoldReadm,
lda = fitLDAKfoldReadm,
nb = fitNbKfoldReadm,
logr = fitLLKfoldReadm,
svm = fitSvmKfoldReadm,
rf = fitRfKfoldReadm))
tikzDevice::tikz("classification_readmission", width = 6, height = 5)
summary(resultsReadmKfold); dotplot(resultsReadmKfold)
dev.off()
summary(resultsReadmKfold);
tikzDevice::tikz("classification_readmission", width = 6, height = 5)
dotplot(resultsReadmKfold, main = "Re-admission")
dev.off()
