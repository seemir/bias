#' @references Zhang Z. Univariate description and bivariate
#' statistical inference: the first step delving into data.
#' Ann Transl Med. 2016 Mar;4(5):91.
?CBCgrps
source("utilities.R")
ACT <- clustMf$ACT
HC <- clustMf$HC
KM <- clustMf$KM
EM <- clustMf$EM
# ----------------------------------------------------------- #
# Compare baseline characteristics HFpEF
# ----------------------------------------------------------- #
compare.baseline(cbind(HFpEFimp, ACT), "ACT")
source("utilities.R")
ACT <- clustMf$ACT
HC <- clustMf$HC
KM <- clustMf$KM
EM <- clustMf$EM
# ----------------------------------------------------------- #
# Compare baseline characteristics HFpEF
# ----------------------------------------------------------- #
compare.baseline(cbind(HFpEFimp, ACT), "ACT")
source("utilities.R")
ACT <- clustMf$ACT
HC <- clustMf$HC
KM <- clustMf$KM
EM <- clustMf$EM
# ----------------------------------------------------------- #
# Compare baseline characteristics HFpEF
# ----------------------------------------------------------- #
compare.baseline(cbind(HFpEFimp, ACT), "ACT")
source("utilities.R")
ACT <- clustMf$ACT
HC <- clustMf$HC
KM <- clustMf$KM
EM <- clustMf$EM
# ----------------------------------------------------------- #
# Compare baseline characteristics HFpEF
# ----------------------------------------------------------- #
compare.baseline(cbind(HFpEFimp, ACT), "ACT")
source("utilities.R")
ACT <- clustMf$ACT
HC <- clustMf$HC
KM <- clustMf$KM
EM <- clustMf$EM
# ----------------------------------------------------------- #
# Compare baseline characteristics HFpEF
# ----------------------------------------------------------- #
compare.baseline(cbind(HFpEFimp, ACT), "ACT")
source("utilities.R")
ACT <- clustMf$ACT
HC <- clustMf$HC
KM <- clustMf$KM
EM <- clustMf$EM
# ----------------------------------------------------------- #
# Compare baseline characteristics HFpEF
# ----------------------------------------------------------- #
compare.baseline(cbind(HFpEFimp, ACT), "ACT")
source("utilities.R")
ACT <- clustMf$ACT
HC <- clustMf$HC
KM <- clustMf$KM
EM <- clustMf$EM
# ----------------------------------------------------------- #
# Compare baseline characteristics HFpEF
# ----------------------------------------------------------- #
compare.baseline(cbind(HFpEFimp, ACT), "ACT")
ACT <- clustMf$ACT
HC <- clustMf$HC
KM <- clustMf$KM
EM <- clustMf$EM
# ----------------------------------------------------------- #
# Compare baseline characteristics HFpEF
# ----------------------------------------------------------- #
compare.baseline(cbind(HFpEFimp, ACT), "ACT")
source("utilities.R")
ACT <- clustMf$ACT
HC <- clustMf$HC
KM <- clustMf$KM
EM <- clustMf$EM
# ----------------------------------------------------------- #
# Compare baseline characteristics HFpEF
# ----------------------------------------------------------- #
compare.baseline(cbind(HFpEFimp, ACT), "ACT")
source("utilities.R")
ACT <- clustMf$ACT
HC <- clustMf$HC
KM <- clustMf$KM
EM <- clustMf$EM
# ----------------------------------------------------------- #
# Compare baseline characteristics HFpEF
# ----------------------------------------------------------- #
compare.baseline(cbind(HFpEFimp, ACT), "ACT")
source("utilities.R")
ACT <- clustMf$ACT
HC <- clustMf$HC
KM <- clustMf$KM
EM <- clustMf$EM
# ----------------------------------------------------------- #
# Compare baseline characteristics HFpEF
# ----------------------------------------------------------- #
compare.baseline(cbind(HFpEFimp, ACT), "ACT")
source("utilities.R")
ACT <- clustMf$ACT
HC <- clustMf$HC
KM <- clustMf$KM
EM <- clustMf$EM
# ----------------------------------------------------------- #
# Compare baseline characteristics HFpEF
# ----------------------------------------------------------- #
compare.baseline(cbind(HFpEFimp, ACT), "ACT")
ACT <- clustPer$ACT
HC <- clustPer$HC
KM <- clustPer$KM
EM <- clustPer$EM
# ----------------------------------------------------------- #
# Compare baseline characteristics HFpEF
# ----------------------------------------------------------- #
compare.baseline(cbind(HFpEFimp, ACT), "ACT")
clustPef <- pca.cluster.plot(HFpEFpca, 2, km.clust = 3,
hc.clust = 3, em.clust = 3,
return.clust = T, ellipse = F)
clustMf <- pca.cluster.plot(HFmrEFpca, 2, km.clust = 3,
hc.clust = 3, em.clust = 3,
return.clust = T, ellipse = F)
# ----------------------------------------------------------- #
ACT <- clustPer$ACT
HC <- clustPer$HC
KM <- clustPer$KM
EM <- clustPer$EM
# ----------------------------------------------------------- #
# Compare baseline characteristics HFpEF
# ----------------------------------------------------------- #
compare.baseline(cbind(HFpEFimp, ACT), "ACT")
ACT <- clustPef$ACT
HC <- clustPef$HC
KM <- clustPef$KM
EM <- clustPef$EM
# ----------------------------------------------------------- #
# Compare baseline characteristics HFpEF
# ----------------------------------------------------------- #
compare.baseline(cbind(HFpEFimp, ACT), "ACT")
HC <- clustPef$HC
KM <- clustPef$KM
EM <- clustPef$EM
# ----------------------------------------------------------- #
# Compare baseline characteristics HFpEF
# ----------------------------------------------------------- #
compare.baseline(cbind(HFpEFimp, HC), "HC")
source("utilities.R")
HC <- clustPef$HC
KM <- clustPef$KM
EM <- clustPef$EM
# ----------------------------------------------------------- #
# Compare baseline characteristics HFpEF
# ----------------------------------------------------------- #
compare.baseline(cbind(HFpEFimp, HC), "HC")
source("utilities.R")
source("utilities.R")
HC <- clustPef$HC
KM <- clustPef$KM
EM <- clustPef$EM
# ----------------------------------------------------------- #
# Compare baseline characteristics HFpEF
# ----------------------------------------------------------- #
compare.baseline(cbind(HFpEFimp, HC), "HC")
compare.baseline(cbind(HFpEFimp, KM), "KM")
compare.baseline(cbind(HFpEFImp, EM), "EM")
compare.baseline(cbind(HFpEFimp, EM), "EM")
# ----------------------------------------------------------- #
# Install relevant packages (if not already done)
# ----------------------------------------------------------- #
Packages <- c("NbClust")
# install.packages(Packages)
# ----------------------------------------------------------- #
# Load relevant packages
# ----------------------------------------------------------- #
lapply(Packages, library, character.only = TRUE)
source("utilities.R")
# ----------------------------------------------------------- #
# Load pca objects and source utility functions
# ----------------------------------------------------------- #
allDataFiles <- c("HFfullpca", "HFpEFpca", "HFmrEFpca",
"HFfullImp","HFpEFimp", "HFmrEFimp",
"SyndClass")
lapply(gsub(" ", "", paste("data_files/", allDataFiles,
".Rdat")), load,.GlobalEnv)
clustFull <- pca.cluster.plot(HFfullpca, 2, km.clust = 2,
hc.clust = 2, em.clust = 2,
actual = SyndClass[,2],
return.clust = T, ellipse = F)
ACT <- clustFull$ACT
HC <- clustFull$HC
KM <- clustFull$KM
EM <- clustFull$EM
compare.baseline(cbind(HFfullImp, ACT), "ACT")
compare.baseline(cbind(HFfullImp, HC), "HC")
compare.baseline(cbind(HFfullImp, KM), "KM")
compare.baseline(cbind(HFfullImp, EM), "EM")
HC <- clustPef$HC
KM <- clustPef$KM
EM <- clustPef$EM
compare.baseline(cbind(HFpEFimp, HC), "HC")
clustPef <- pca.cluster.plot(HFpEFpca, 2, km.clust = 3,
hc.clust = 3, em.clust = 3,
return.clust = T, ellipse = F)
clustMf <- pca.cluster.plot(HFmrEFpca, 2, km.clust = 3,
hc.clust = 3, em.clust = 3,
return.clust = T, ellipse = F)
# ----------------------------------------------------------- #
# Compare baseline characteristics HFpEF
# ----------------------------------------------------------- #
HC <- clustPef$HC
KM <- clustPef$KM
EM <- clustPef$EM
compare.baseline(cbind(HFpEFimp, HC), "HC")
compare.baseline(cbind(HFpEFimp, KM), "KM")
compare.baseline(cbind(HFpEFimp, EM), "EM")
# ----------------------------------------------------------- #
# Install packages (if not already installed)
# ----------------------------------------------------------- #
Packages <- c("BaylorEdPsych", "Amelia", "mice", "NbClust",
"caret", "rlist", "xtable")
# install.packages(Packages)
# ----------------------------------------------------------- #
# Load package for docstring
# ----------------------------------------------------------- #
lapply(Packages, library, character.only = TRUE)
allDataFiles <- c("HFpEFind", "HFmrEFind",
"HFpEFnoInd", "HFmrEFnoInd",
"HFfullDataSet", "SyndClass")
lapply(gsub(" ", "", paste("data_files/", allDataFiles,
".Rdat")), load,.GlobalEnv)
source("utilities.R")
top.n.missing(HFfullDataSet, 10)
top.n.missing(cbind(HFmrEFnoInd, HFmrEFind), 10)
top.n.missing(cbind(HFpEFnoInd, HFpEFind), 10)
CutOff <- 0.20 # cut.off percentage
HFfullInd <- rm.missing(HFfullInd, cut.off = CutOff,
near.zero.var = F)
HFfullNoInd <- rm.missing(HFfullNoInd, cut.off = CutOff)
HFfullList <- list(HFfullInd, HFfullNoInd)
HFfullMcar <- do.call(rbind, lapply(HFfullList, little.mcar))
HFfullCarNames <- c("indicator","continuous")
rownames(HFfullMcar) <- HFfullCarNames
HFfullRmInd <- rm.indicator(HFfullDataSet, 8)
HFfullInd <- HFfullRmInd$indicator
HFfullNoInd <- HFfullRmInd$non.indicator
CutOff <- 0.20 # cut.off percentage
HFfullInd <- rm.missing(HFfullInd, cut.off = CutOff,
near.zero.var = F)
HFfullNoInd <- rm.missing(HFfullNoInd, cut.off = CutOff)
HFfullList <- list(HFfullInd, HFfullNoInd)
HFfullMcar <- do.call(rbind, lapply(HFfullList, little.mcar))
HFfullCarNames <- c("indicator","continuous")
rownames(HFfullMcar) <- HFfullCarNames
CutOff <- 0.15 # cut.off percentage
HFpEFind <- rm.missing(HFpEFind, cut.off = CutOff,
near.zero.var = F)
HFpEFnoInd <- rm.missing(HFpEFnoInd, cut.off = CutOff)
HFpEFlist <- list(HFpEFind, HFpEFnoInd)
HFpEFmcar <- do.call(rbind, lapply(HFpEFlist, little.mcar))
HFpEFmcarNames <- c("indicator","continuous")
rownames(HFpEFmcar) <- HFpEFmcarNames
CutOff <- 0.25 # cut.off percentage
HFmrEFind <- rm.missing(HFmrEFind, cut.off = CutOff,
near.zero.var = F)
HFmrEFnoInd <- rm.missing(HFmrEFnoInd, cut.off = CutOff)
HFmrEFlist <- list(HFmrEFind, HFmrEFnoInd)
HFmrEFmcar <- do.call(rbind, lapply(HFmrEFlist, little.mcar))
HFmrEFmcarNames <- c("indicator","continuous")
rownames(HFmrEFmcar) <- HFmrEFmcarNames
xtable(rbind(HFfullMcar, HFpEFmcar, HFmrEFmcar),
digits = c(0,0,0,4,0,5))
HFmrEFmcar
rbind(HFfullMcar, HFpEFmcar, HFmrEFmcar)
top.n.missing(cbind(HFfullNoInd, HFfullInd), n = 10)
top.n.missing(cbind(HFpEFnoInd, HFpEFind), n = 10)
top.n.missing(cbind(HFmrEFnoInd, HFmrEFind), n = 10)
m <- 100 # number of bootstrap samples
bnd <- data.bounds(HFfullNoInd, 0, Inf)
HFfullEm <- boot.em.impute(HFfullNoInd, bnd, n.boot = m)
HFfullCart <- complete(mice(HFfullInd, method = "cart"))
HFpEFconImpEmList <- HFmrEFconImpEmList <- list()
HFpEFbound   <- data.bounds(HFpEFnoInd, 0, Inf)
HFpEFem <- boot.em.impute(HFpEFnoInd, bounds = HFpEFbound,
n.boot = m)
HFpEFcart <- complete(mice(HFpEFind, method ="cart"))
HFmrEFbound <- data.bounds(HFmrEFnoInd, 0, Inf)
HFmrEFem <- boot.em.impute(HFmrEFnoInd,
bounds = HFmrEFbound,
n.boot = m)
HFmrEFcart <- complete(mice(HFmrEFind, method ="cart"))
HFfullImp <- cbind(HFfullEm, HFfullCart)
HFpEFimp <- cbind(HFpEFem, HFpEFcart)
HFmrEFimp <- cbind(HFmrEFem, HFmrEFcart)
HFfullImp <- sort.column.names(HFfullImp, id.col = T)
HFpEFimp <- sort.column.names(HFpEFimp, id.col = T)
HFmrEFimp <- sort.column.names(HFmrEFimp, id.col = T)
# ----------------------------------------------------------- #
# Install relevant packages (if not already done)
# ----------------------------------------------------------- #
Packages <- c("NbClust")
# install.packages(Packages)
# ----------------------------------------------------------- #
# Load relevant packages
# ----------------------------------------------------------- #
lapply(Packages, library, character.only = TRUE)
source("utilities.R")
allDataFiles <- c("HFfullpca", "HFpEFpca", "HFmrEFpca",
"HFfullImp","HFpEFimp", "HFmrEFimp",
"SyndClass")
lapply(gsub(" ", "", paste("data_files/", allDataFiles,
".Rdat")), load,.GlobalEnv)
clustFull <- pca.cluster.plot(HFfullpca, 2, km.clust = 2,
hc.clust = 2, em.clust = 2,
actual = SyndClass[,2],
return.clust = T, ellipse = F)
ACT <- clustFull$ACT
HC <- clustFull$HC
KM <- clustFull$KM
EM <- clustFull$EM
# ----------------------------------------------------------- #
# Compare baseline characteristics
# ----------------------------------------------------------- #
compare.baseline(cbind(HFfullImp, ACT), "ACT")
compare.baseline(cbind(HFfullImp, HC), "HC")
# ----------------------------------------------------------- #
# Install relevant packages (if not already done)
# ----------------------------------------------------------- #
Packages <- c("NbClust")
# install.packages(Packages)
# ----------------------------------------------------------- #
# Load relevant packages
# ----------------------------------------------------------- #
lapply(Packages, library, character.only = TRUE)
source("utilities.R")
# ----------------------------------------------------------- #
# Load pca objects and source utility functions
# ----------------------------------------------------------- #
allDataFiles <- c("HFfullpca", "HFpEFpca", "HFmrEFpca",
"HFfullImp","HFpEFimp", "HFmrEFimp",
"SyndClass")
lapply(gsub(" ", "", paste("data_files/", allDataFiles,
".Rdat")), load,.GlobalEnv)
NbClust(HFfullpca$scores[,1:31], min.nc = 2, max.nc = 4,
method = "kmeans")
NbClust(HFpEFpca$scores[,1:31], min.nc = 2, max.nc = 4,
method = "kmeans")
NbClust(HFmrEFpca$scores[,1:31], min.nc = 2, max.nc = 4,
method = "kmeans")
clustFull <- pca.cluster.plot(HFfullpca, 2, km.clust = 2,
hc.clust = 2, em.clust = 2,
actual = SyndClass[,2],
return.clust = T, ellipse = F)
ACT <- clustFull$ACT
HC <- clustFull$HC
KM <- clustFull$KM
EM <- clustFull$EM
# ----------------------------------------------------------- #
# Compare baseline characteristics
# ----------------------------------------------------------- #
compare.baseline(cbind(HFfullImp, ACT), "ACT")
compare.baseline(cbind(HFfullImp, HC), "HC")
compare.baseline(cbind(HFfullImp, KM), "KM")
compare.baseline(cbind(HFfullImp, EM), "EM")
clustPef <- pca.cluster.plot(HFpEFpca, 2, km.clust = 3,
hc.clust = 3, em.clust = 3,
return.clust = T, ellipse = F)
clustMf <- pca.cluster.plot(HFmrEFpca, 2, km.clust = 3,
hc.clust = 3, em.clust = 3,
return.clust = T, ellipse = F)
HC <- clustPef$HC
HC <- clustPef$HC
KM <- clustPef$KM
EM <- clustPef$EM
compare.baseline(cbind(HFpEFimp, HC), "HC")
compare.baseline(cbind(HFpEFimp, KM), "KM")
compare.baseline(cbind(HFpEFimp, EM), "EM")
HC <- clustMr$HC
KM <- clustMr$KM
EM <- clustMr$EM
compare.baseline(cbind(HFmEFimp, HC), "HC")
clustMf <- pca.cluster.plot(HFmrEFpca, 2, km.clust = 3,
hc.clust = 3, em.clust = 3,
return.clust = T, ellipse = F)
compare.baseline(cbind(HFmEFimp, HC), "HC")
compare.baseline(cbind(HFmrEFimp, HC), "HC")
compare.baseline(cbind(HFmrEFimp, KM), "KM")
clustMr <- pca.cluster.plot(HFmrEFpca, 2, km.clust = 3,
hc.clust = 3, em.clust = 3,
return.clust = T, ellipse = F)
HC <- clustMr$HC
KM <- clustMr$KM
EM <- clustMr$EM
compare.baseline(cbind(HFmrEFimp, HC), "HC")
compare.baseline(cbind(HFmrEFimp, KM), "KM")
compare.baseline(cbind(HFmrEFimp, EM), "EM")
# ----------------------------------------------------------- #
# Install relevant packages (if not already done)
# ----------------------------------------------------------- #
Packages <- c("NbClust")
# install.packages(Packages)
# ----------------------------------------------------------- #
# Load relevant packages
# ----------------------------------------------------------- #
lapply(Packages, library, character.only = TRUE)
source("utilities.R")
allDataFiles <- c("HFfullpca", "HFpEFpca", "HFmrEFpca",
"HFfullImp","HFpEFimp", "HFmrEFimp",
"SyndClass")
lapply(gsub(" ", "", paste("data_files/", allDataFiles,
".Rdat")), load,.GlobalEnv)
clustFull <- pca.cluster.plot(HFfullpca, 2, km.clust = 2,
hc.clust = 2, em.clust = 2,
actual = SyndClass[,2],
return.clust = T, ellipse = F)
# ----------------------------------------------------------- #
# Install relevant packages (if not already done)
# ----------------------------------------------------------- #
Packages <- c("NbClust")
# install.packages(Packages)
# ----------------------------------------------------------- #
# Load relevant packages
# ----------------------------------------------------------- #
lapply(Packages, library, character.only = TRUE)
source("utilities.R")
# ----------------------------------------------------------- #
# Load pca objects and source utility functions
# ----------------------------------------------------------- #
allDataFiles <- c("HFfullpca", "HFpEFpca", "HFmrEFpca",
"HFfullImp","HFpEFimp", "HFmrEFimp",
"SyndClass")
lapply(gsub(" ", "", paste("data_files/", allDataFiles,
".Rdat")), load,.GlobalEnv)
# ----------------------------------------------------------- #
# Determine optimal number of clusters
# ----------------------------------------------------------- #
NbClust(HFfullpca$scores[,1:31], min.nc = 2, max.nc = 4,
method = "kmeans")
NbClust(HFpEFpca$scores[,1:31], min.nc = 2, max.nc = 4,
method = "kmeans")
NbClust(HFmrEFpca$scores[,1:31], min.nc = 2, max.nc = 4,
method = "kmeans")
# ----------------------------------------------------------- #
# PCA cluster plot for all data sets
# ----------------------------------------------------------- #
clustFull <- pca.cluster.plot(HFfullpca, 2, km.clust = 2,
hc.clust = 2, em.clust = 2,
actual = SyndClass[,2],
return.clust = T, ellipse = F)
clustFull <- pca.cluster.plot(HFfullpca, 31, km.clust = 2,
hc.clust = 2, em.clust = 2,
actual = SyndClass[,2],
return.clust = T, ellipse = F)
\cite(princomp)
cite(princomp)
cite("princomp")
cite("princomp()")
?cite
?princomp
?princomp$references
citation("princomp")
citation("stats")
# ----------------------------------------------------------- #
# Install relevant packages (if not already done)
# ----------------------------------------------------------- #
Packages <- c("NbClust")
# install.packages(Packages)
# ----------------------------------------------------------- #
# Load relevant packages
# ----------------------------------------------------------- #
lapply(Packages, library, character.only = TRUE)
source("utilities.R")
# ----------------------------------------------------------- #
# Load pca objects and source utility functions
# ----------------------------------------------------------- #
allDataFiles <- c("HFfullpca", "HFpEFpca", "HFmrEFpca",
"HFfullImp","HFpEFimp", "HFmrEFimp",
"SyndClass")
lapply(gsub(" ", "", paste("data_files/", allDataFiles,
".Rdat")), load,.GlobalEnv)
?Nbclust
?NbClust
pca.cluster.plot
?HCPC
source("utilities.R")
?pca.cluster.plot
citation("HCPC")
?HCPC
??HCPC
citation("Factomine")
citation("FactoMine")
citation("FactoMineR")
pca.cluster.plot
# ----------------------------------------------------------- #
# Install relevant packages (if not already done)
# ----------------------------------------------------------- #
Packages <- c("NbClust")
# install.packages(Packages)
# ----------------------------------------------------------- #
# Load relevant packages
# ----------------------------------------------------------- #
lapply(Packages, library, character.only = TRUE)
source("utilities.R")
pca.cluster.plot
?HCPC
citation("NbClust")
?Nbclust
?NbClust
pca.cluster.plot
?kmeans
