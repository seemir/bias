test <- dat[-index, ]
# Fitting
model <- glm(syndrome~.,family=binomial,data=train)
# Predict results
results_prob <- predict(model,test,type='response')
# If prob > 0.5 then 1, else 0
results <- ifelse(results_prob > 0.5,1,0)
# Actual answers
answers <- test$Creditability
# Accuracy calculation
misClasificError <- mean(answers != results)
# Collecting results
acc[i] <- 1-misClasificError
# Confusion matrix
cm <- confusionMatrix(data=results, reference=answers)
fpr[i] <- cm$table[2]/(nrow(dat)-smp_size)
fnr[i] <- cm$table[3]/(nrow(dat)-smp_size)
pbar$step()
}
library(caret)
library(plyr)
syndrome <- ifelse(SyndClass[-328, 2]==2, 1, 0)
dat <- cbind(syndrome, HFfullImpDataSet[-328,])
fpr <- NULL # False positive rate
fnr <- NULL # False negative rate
k <- 500 # Number of iterations
# Accuracy
acc <- NULL
for(i in 1:k)
{
# Train-test splitting
# 95% of samples -> fitting
# 5% of samples -> testing
smp_size <- floor(0.95 * nrow(dat))
index <- sample(seq_len(nrow(dat)),size=smp_size)
train <- dat[index, ]
test <- dat[-index, ]
# Fitting
model <- glm(syndrome~.,family=binomial,data=train)
# Predict results
results_prob <- predict(model,test,type='response')
# If prob > 0.5 then 1, else 0
results <- ifelse(results_prob > 0.5,1,0)
# Actual answers
answers <- test$syndrome
# Accuracy calculation
misClasificError <- mean(answers != results)
# Collecting results
acc[i] <- 1-misClasificError
# Confusion matrix
cm <- confusionMatrix(data=results, reference=answers)
fpr[i] <- cm$table[2]/(nrow(dat)-smp_size)
fnr[i] <- cm$table[3]/(nrow(dat)-smp_size)
pbar$step()
}
mean(acc)
par(mfcol=c(1,2))
hist(acc,xlab='Accuracy',ylab='Freq',
col='cyan',border='blue',density=30)
# Boxplot of accuracy
boxplot(acc,col='cyan',border='blue',horizontal=T,xlab='Accuracy',
main='Accuracy CV')
syndrome <- as.factor(ifelse(SyndClass[-328, 2]==2, 1, 0))
dat <- cbind(syndrome, HFfullImpDataSet[-328,])
fpr <- NULL # False positive rate
fnr <- NULL # False negative rate
k <- 500 # Number of iterations
# Accuracy
acc <- NULL
for(i in 1:k)
{
# Train-test splitting
# 95% of samples -> fitting
# 5% of samples -> testing
smp_size <- floor(0.95 * nrow(dat))
index <- sample(seq_len(nrow(dat)),size=smp_size)
train <- dat[index, ]
test <- dat[-index, ]
# Fitting
model <- glm(syndrome~.,family=binomial,data=train)
# Predict results
results_prob <- predict(model, test, type='response')
# If prob > 0.5 then 1, else 0
results <- ifelse(results_prob > 0.5,1,0)
# Actual answers
answers <- test$syndrome
# Accuracy calculation
misClasificError <- mean(answers != results)
# Collecting results
acc[i] <- 1-misClasificError
# Confusion matrix
cm <- confusionMatrix(data=results, reference=answers)
fpr[i] <- cm$table[2]/(nrow(dat)-smp_size)
fnr[i] <- cm$table[3]/(nrow(dat)-smp_size)
pbar$step()
}
syndrome <- ifelse(SyndClass[-328, 2]==2, 1, 0)
dat <- cbind(syndrome, HFfullImpDataSet[-328,])
fpr <- NULL # False positive rate
fnr <- NULL # False negative rate
k <- 500 # Number of iterations
# Accuracy
acc <- NULL
for(i in 1:k)
{
# Train-test splitting
# 95% of samples -> fitting
# 5% of samples -> testing
smp_size <- floor(0.95 * nrow(dat))
index <- sample(seq_len(nrow(dat)),size=smp_size)
train <- dat[index, ]
test <- dat[-index, ]
# Fitting
model <- glm(syndrome~.,family=binomial,data=train)
# Predict results
results_prob <- predict(model, test, type='response')
# If prob > 0.5 then 1, else 0
results <- ifelse(results_prob > 0.5,1,0)
# Actual answers
answers <- test$syndrome
# Accuracy calculation
misClasificError <- mean(answers != results)
# Collecting results
acc[i] <- 1-misClasificError
# Confusion matrix
cm <- confusionMatrix(data=results, reference=answers)
fpr[i] <- cm$table[2]/(nrow(dat)-smp_size)
fnr[i] <- cm$table[3]/(nrow(dat)-smp_size)
pbar$step()
}
seq_len
syndrome <- ifelse(SyndClass[-328, 2]==2, 1, 0)
dat <- cbind(syndrome, HFfullImpDataSet[-328,])
fpr <- NULL # False positive rate
fnr <- NULL # False negative rate
k <- 500 # Number of iterations
# Accuracy
acc <- NULL
for(i in 1:k)
{
# Train-test splitting
# 95% of samples -> fitting
# 5% of samples -> testing
smp_size <- floor(0.95 * nrow(dat))
index <- sample(seq_len(nrow(dat)),size=smp_size)
train <- dat[index, ]
test <- dat[-index, ]
# Fitting
model <- glm(syndrome~.,family=binomial,data=train)
# Predict results
results_prob <- predict(model, subset(test,select=c(2:55)), type='response')
# If prob > 0.5 then 1, else 0
results <- ifelse(results_prob > 0.5,1,0)
# Actual answers
answers <- test$syndrome
# Accuracy calculation
misClasificError <- mean(answers != results)
# Collecting results
acc[i] <- 1-misClasificError
# Confusion matrix
cm <- confusionMatrix(data=results, reference=answers)
fpr[i] <- cm$table[2]/(nrow(dat)-smp_size)
fnr[i] <- cm$table[3]/(nrow(dat)-smp_size)
pbar$step()
}
View(dat)
library(caret)
library(plyr)
syndrome <- ifelse(SyndClass[-328, 2]==2, 1, 0)
dat <- cbind(syndrome, HFfullImpDataSet[-328,])
dat <- dat[, 1:28]
fpr <- NULL # False positive rate
fnr <- NULL # False negative rate
k <- 500 # Number of iterations
# Accuracy
acc <- NULL
for(i in 1:k)
{
# Train-test splitting
# 95% of samples -> fitting
# 5% of samples -> testing
smp_size <- floor(0.95 * nrow(dat))
index <- sample(seq_len(nrow(dat)), size=smp_size)
train <- dat[index, ]
test <- dat[-index, ]
# Fitting
model <- glm(syndrome~.,family=binomial,data=train)
# Predict results
results_prob <- predict(model, subset(test, select=c(2:55)),
type='response')
# If prob > 0.5 then 1, else 0
results <- ifelse(results_prob > 0.5, 1, 0)
# Actual answers
answers <- test$syndrome
# Accuracy calculation
misClasificError <- mean(answers != results)
# Collecting results
acc[i] <- 1-misClasificError
# Confusion matrix
cm <- confusionMatrix(data=results, reference=answers)
fpr[i] <- cm$table[2]/(nrow(dat)-smp_size)
fnr[i] <- cm$table[3]/(nrow(dat)-smp_size)
pbar$step()
}
syndrome <- ifelse(SyndClass[-328, 2]==2, 1, 0)
dat <- cbind(syndrome, HFfullImpDataSet[-328,])
fpr <- NULL # False positive rate
fnr <- NULL # False negative rate
k <- 500 # Number of iterations
# Accuracy
acc <- NULL
for(i in 1:k)
{
# Train-test splitting
# 95% of samples -> fitting
# 5% of samples -> testing
smp_size <- floor(0.95 * nrow(dat))
index <- sample(seq_len(nrow(dat)), size=smp_size)
train <- dat[index, ]
test <- dat[-index, ]
# Fitting
model <- glm(syndrome~.,family=binomial,data=train)
# Predict results
results_prob <- predict(model, subset(test, select=c(2:55)),
type='response')
# If prob > 0.5 then 1, else 0
results <- ifelse(results_prob > 0.5, 1, 0)
# Actual answers
answers <- test$syndrome
# Accuracy calculation
misClasificError <- mean(answers != results)
# Collecting results
acc[i] <- 1-misClasificError
# Confusion matrix
cm <- confusionMatrix(data=results, reference=answers)
fpr[i] <- cm$table[2]/(nrow(dat)-smp_size)
fnr[i] <- cm$table[3]/(nrow(dat)-smp_size)
pbar$step()
}
syndrome <- ifelse(SyndClass[-328, 2]==2, 1, 0)
dat <- cbind(syndrome, HFfullpca$scores[-328,])
fpr <- NULL # False positive rate
fnr <- NULL # False negative rate
k <- 500 # Number of iterations
# Accuracy
acc <- NULL
for(i in 1:k)
{
# Train-test splitting
# 95% of samples -> fitting
# 5% of samples -> testing
smp_size <- floor(0.95 * nrow(dat))
index <- sample(seq_len(nrow(dat)), size=smp_size)
train <- dat[index, ]
test <- dat[-index, ]
# Fitting
model <- glm(syndrome~.,family=binomial,data=train)
# Predict results
results_prob <- predict(model, subset(test, select=c(2:55)),
type='response')
# If prob > 0.5 then 1, else 0
results <- ifelse(results_prob > 0.5, 1, 0)
# Actual answers
answers <- test$syndrome
# Accuracy calculation
misClasificError <- mean(answers != results)
# Collecting results
acc[i] <- 1-misClasificError
# Confusion matrix
cm <- confusionMatrix(data=results, reference=answers)
fpr[i] <- cm$table[2]/(nrow(dat)-smp_size)
fnr[i] <- cm$table[3]/(nrow(dat)-smp_size)
pbar$step()
}
syndrome <- ifelse(SyndClass[-328, 2]==2, 1, 0)
dat <- as.data.frame(cbind(syndrome, HFfullpca$scores[-328,]))
fpr <- NULL # False positive rate
fnr <- NULL # False negative rate
k <- 500 # Number of iterations
# Accuracy
acc <- NULL
for(i in 1:k)
{
# Train-test splitting
# 95% of samples -> fitting
# 5% of samples -> testing
smp_size <- floor(0.95 * nrow(dat))
index <- sample(seq_len(nrow(dat)), size=smp_size)
train <- dat[index, ]
test <- dat[-index, ]
# Fitting
model <- glm(syndrome~.,family=binomial,data=train)
# Predict results
results_prob <- predict(model, subset(test, select=c(2:55)),
type='response')
# If prob > 0.5 then 1, else 0
results <- ifelse(results_prob > 0.5, 1, 0)
# Actual answers
answers <- test$syndrome
# Accuracy calculation
misClasificError <- mean(answers != results)
# Collecting results
acc[i] <- 1-misClasificError
# Confusion matrix
cm <- confusionMatrix(data=results, reference=answers)
fpr[i] <- cm$table[2]/(nrow(dat)-smp_size)
fnr[i] <- cm$table[3]/(nrow(dat)-smp_size)
pbar$step()
}
library(caret)
library(plyr)
syndrome <- ifelse(SyndClass[-328, 2]==2, 1, 0)
dat <- as.data.frame(cbind(syndrome, HFfullpca$scores[-328,]))
fpr <- NULL # False positive rate
fnr <- NULL # False negative rate
k <- 500 # Number of iterations
# Accuracy
acc <- NULL
for(i in 1:k)
{
# Train-test splitting
# 95% of samples -> fitting
# 5% of samples -> testing
smp_size <- floor(0.95 * nrow(dat))
index <- sample(seq_len(nrow(dat)), size=smp_size)
train <- dat[index, ]
test <- dat[-index, ]
# Fitting
model <- glm(syndrome~.,family=binomial,data=train)
# Predict results
results_prob <- predict(model, subset(test, select=c(2:55)),
type='response')
# If prob > 0.5 then 1, else 0
results <- ifelse(results_prob > 0.5, 1, 0)
# Actual answers
answers <- as.factor(test$syndrome)
# Accuracy calculation
misClasificError <- mean(answers != results)
# Collecting results
acc[i] <- 1-misClasificError
# Confusion matrix
cm <- confusionMatrix(data=results, reference=answers)
fpr[i] <- cm$table[2]/(nrow(dat)-smp_size)
fnr[i] <- cm$table[3]/(nrow(dat)-smp_size)
pbar$step()
}
syndrome <- ifelse(SyndClass[-328, 2]==2, 1, 0)
dat <- as.data.frame(cbind(syndrome, HFfullpca$scores[-328,]))
fpr <- NULL # False positive rate
fnr <- NULL # False negative rate
k <- 500 # Number of iterations
# Accuracy
acc <- NULL
for(i in 1:k)
{
# Train-test splitting
# 95% of samples -> fitting
# 5% of samples -> testing
smp_size <- floor(0.95 * nrow(dat))
index <- sample(seq_len(nrow(dat)), size=smp_size)
train <- dat[index, ]
test <- dat[-index, ]
# Fitting
model <- glm(syndrome~.,family=binomial,data=train)
# Predict results
results_prob <- predict(model, subset(test, select=c(2:55)),
type='response')
# If prob > 0.5 then 1, else 0
results <- as.factor(ifelse(results_prob > 0.5, 1, 0))
# Actual answers
answers <- as.factor(test$syndrome)
# Accuracy calculation
misClasificError <- mean(answers != results)
# Collecting results
acc[i] <- 1-misClasificError
# Confusion matrix
cm <- confusionMatrix(data=results, reference=answers)
fpr[i] <- cm$table[2]/(nrow(dat)-smp_size)
fnr[i] <- cm$table[3]/(nrow(dat)-smp_size)
pbar$step()
}
library(caret)
library(plyr)
syndrome <- ifelse(SyndClass[-328, 2]==2, 1, 0)
dat <- as.data.frame(cbind(syndrome, HFfullpca$scores[-328,]))
fpr <- NULL # False positive rate
fnr <- NULL # False negative rate
k <- 500 # Number of iterations
# Accuracy
acc <- NULL
for(i in 1:k)
{
# Train-test splitting
# 95% of samples -> fitting
# 5% of samples -> testing
smp_size <- floor(0.95 * nrow(dat))
index <- sample(seq_len(nrow(dat)), size=smp_size)
train <- dat[index, ]
test <- dat[-index, ]
# Fitting
model <- glm(syndrome~.,family=binomial,data=train)
# Predict results
results_prob <- predict(model, subset(test, select=c(2:55)),
type='response')
# If prob > 0.5 then 1, else 0
results <- as.factor(ifelse(results_prob > 0.5, 1, 0))
# Actual answers
answers <- as.factor(test$syndrome)
# Accuracy calculation
misClasificError <- mean(answers != results)
# Collecting results
acc[i] <- 1-misClasificError
# Confusion matrix
cm <- confusionMatrix(data=results, reference=answers)
fpr[i] <- cm$table[2]/(nrow(dat)-smp_size)
fnr[i] <- cm$table[3]/(nrow(dat)-smp_size)
}
acc
mean(acc[acc != 1])
# Histogram of accuracy
hist(acc,xlab='Accuracy',ylab='Freq',
col='cyan',border='blue',density=30)
# Boxplot of accuracy
boxplot(acc,col='cyan',border='blue',horizontal=T,xlab='Accuracy',
main='Accuracy CV')
# Confusion matrix and plots of fpr and fnr
mean(fpr)
mean(fnr)
hist(fpr,xlab='% of fnr',ylab='Freq',main='FPR',
col='cyan',border='blue',density=30)
hist(fnr,xlab='% of fnr',ylab='Freq',main='FNR',
col='cyan',border='blue',density=30)
hist(acc,xlab='Accuracy',ylab='Freq',
col='cyan',border='blue',density=30)
boxplot(acc,col='cyan',border='blue',horizontal=T,xlab='Accuracy',
main='Accuracy CV')
mean(fpr)
mean(fnr)
hist(fpr,xlab='% of fnr',ylab='Freq',main='FPR',
col='cyan',border='blue',density=30)
hist(fnr,xlab='% of fnr',ylab='Freq',main='FNR',
col='cyan',border='blue',density=30)
?seq_len
par(mfcol=c(1,2))
# Histogram of accuracy
hist(acc,xlab='Accuracy',ylab='Freq',
col='cyan',border='blue',density=30)
# Boxplot of accuracy
boxplot(acc,col='cyan',border='blue',horizontal=T,xlab='Accuracy',
main='Accuracy CV')
acc <- acc[acc != 1]
mean(acc)
par(mfcol=c(1,2))
# Histogram of accuracy
hist(acc,xlab='Accuracy',ylab='Freq',
col='cyan',border='blue',density=30)
# Boxplot of accuracy
boxplot(acc,col='cyan',border='blue',horizontal=T,xlab='Accuracy',
main='Accuracy CV')
hist(acc,xlab='Accuracy',ylab='Freq',
col='cyan',border='blue',density=30)
boxplot(acc,col='cyan',border='blue',horizontal=T,xlab='Accuracy',
main='Accuracy CV')
syndrome <- ifelse(SyndClass[-328, 2]==2, 1, 0)
dat <- as.data.frame(cbind(syndrome, HFfullpca[-328,]))
fpr <- NULL # False positive rate
fnr <- NULL # False negative rate
k <- 500 # Number of iterations
# Accuracy
acc <- NULL
for(i in 1:k)
{
# Train-test splitting
# 95% of samples -> fitting
# 5% of samples -> testing
smp_size <- floor(0.95 * nrow(dat))
index <- sample(seq_len(nrow(dat)), size=smp_size)
train <- dat[index, ]
test <- dat[-index, ]
# Fitting
model <- glm(syndrome~.,family=binomial,data=train)
# Predict results
results_prob <- predict(model, subset(test, select=c(2:55)),
type='response')
# If prob > 0.5 then 1, else 0
results <- as.factor(ifelse(results_prob > 0.5, 1, 0))
# Actual answers
answers <- as.factor(test$syndrome)
# Accuracy calculation
misClasificError <- mean(answers != results)
# Collecting results
acc[i] <- 1-misClasificError
# Confusion matrix
cm <- confusionMatrix(data=results, reference=answers)
fpr[i] <- cm$table[2]/(nrow(dat)-smp_size)
fnr[i] <- cm$table[3]/(nrow(dat)-smp_size)
}
acc <- acc[acc != 1]
mean(acc)
par(mfcol=c(1,2))
# Histogram of accuracy
hist(acc,xlab='Accuracy',ylab='Freq',
col='cyan',border='blue',density=30)
# Boxplot of accuracy
boxplot(acc,col='cyan',border='blue',horizontal=T,xlab='Accuracy',
main='Accuracy CV')
hist(acc,xlab='Accuracy',ylab='Freq',
col='cyan',border='blue',density=30, breaks = 20)
hist(acc,xlab='Accuracy',ylab='Freq',
col='cyan',border='blue',density=30, breaks = 10)
hist(acc,xlab='Accuracy',ylab='Freq',
col='cyan',border='blue',density=30, breaks = 10)
