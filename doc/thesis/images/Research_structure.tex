
\begin{figure}

\centering

\tikzset{every picture/.style={line width=0.75pt}} %set default line width to 0.75pt        

\begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]
%uncomment if require: \path (0,585); %set diagram left start at 0, and has height of 585

\draw  [fill={rgb, 255:red, 155; green, 155; blue, 155 }  ,fill opacity=0.3 ][dash pattern={on 4.5pt off 4.5pt}]  (205, 231) rectangle (493.5, 467)   ;
\draw  [fill={rgb, 255:red, 155; green, 155; blue, 155 }  ,fill opacity=0.3 ][dash pattern={on 4.5pt off 4.5pt}]  (2, 232) rectangle (165.5, 466)   ;
\draw    (83.5,47) -- (83.5,76) ;
\draw [shift={(83.5,76)}, rotate = 270] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ] [draw opacity=0] (8.93,-4.29) -- (0,0) -- (8.93,4.29) -- (8.93,-4.29)    ;

\draw    (83.5,118) -- (83.5,146) ;
\draw [shift={(83.5,146)}, rotate = 270] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ] [draw opacity=0] (8.93,-4.29) -- (0,0) -- (8.93,4.29) -- (8.93,-4.29)    ;

\draw    (189.5,315) -- (189.5,494) ;


\draw    (189.5,493.5) -- (219.5,494) ;
\draw [shift={(219.5,494)}, rotate = 180.95] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ] [draw opacity=0] (8.93,-4.29) -- (0,0) -- (8.93,4.29) -- (8.93,-4.29)    ;

\draw    (248.5,272) -- (248.5,292.22) ;
\draw [shift={(248.5,292.22)}, rotate = 270] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ] [draw opacity=0] (8.93,-4.29) -- (0,0) -- (8.93,4.29) -- (8.93,-4.29)    ;

\draw    (315.5,272) -- (315.5,292.22) ;
\draw [shift={(315.5,292.22)}, rotate = 270] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ] [draw opacity=0] (8.93,-4.29) -- (0,0) -- (8.93,4.29) -- (8.93,-4.29)    ;

\draw    (380.75,272) -- (380.75,292) ;
\draw [shift={(380.75,292)}, rotate = 270] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ] [draw opacity=0] (8.93,-4.29) -- (0,0) -- (8.93,4.29) -- (8.93,-4.29)    ;

\draw    (445.5,272.39) -- (445.5,291.61) ;
\draw [shift={(445.5,291.61)}, rotate = 270] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ] [draw opacity=0] (8.93,-4.29) -- (0,0) -- (8.93,4.29) -- (8.93,-4.29)    ;

\draw    (248.5,272) -- (445.5,273) ;


\draw    (348.5,452) -- (348.5,494) ;


\draw    (311.5,494) -- (348.5,495) ;

\draw [shift={(311.5,494)}, rotate = 1.55] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ] [draw opacity=0] (8.93,-4.29) -- (0,0) -- (8.93,4.29) -- (8.93,-4.29)    ;
\draw  [fill={rgb, 255:red, 248; green, 231; blue, 28 }  ,fill opacity=0.3 ]  (220, 342) rectangle (475.5, 402)   ;
\draw    (264,202) -- (264,272) ;


\draw  [dash pattern={on 0.84pt off 2.51pt}]  (335.65,48) -- (335.5,148) ;


\draw  [dash pattern={on 0.84pt off 2.51pt}]  (493,203) -- (510,203) ;


\draw  [dash pattern={on 0.84pt off 2.51pt}]  (508,203) -- (509,432) ;


\draw  [dash pattern={on 0.84pt off 2.51pt}]  (477,432) -- (509,432) ;

\draw [shift={(477,432)}, rotate = 0] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ] [draw opacity=0] (8.93,-4.29) -- (0,0) -- (8.93,4.29) -- (8.93,-4.29)    ;
\draw  [fill={rgb, 255:red, 248; green, 231; blue, 28 }  ,fill opacity=0.3 ]  (36, 76) rectangle (131.5, 118)   ;
\draw  [fill={rgb, 255:red, 248; green, 231; blue, 28 }  ,fill opacity=0.3 ]  (35.75, 147) rectangle (131.25, 204)   ;
\draw  [fill={rgb, 255:red, 248; green, 231; blue, 28 }  ,fill opacity=0.3 ]  (36, 293) rectangle (131.5, 335)   ;
\draw  [fill={rgb, 255:red, 248; green, 231; blue, 28 }  ,fill opacity=0.3 ]  (36, 343) rectangle (131.5, 385)   ;
\draw  [fill={rgb, 255:red, 248; green, 231; blue, 28 }  ,fill opacity=0.3 ]  (36, 393) rectangle (131.5, 447)   ;
\draw    (131.5,315) -- (189.5,315) ;


\draw    (131.5,364) -- (188.5,364) ;


\draw    (132.5,419) -- (188.5,419) ;


\draw  [fill={rgb, 255:red, 248; green, 231; blue, 28 }  ,fill opacity=0.3 ]  (293.5, 192.5) rectangle (396.5, 215.5)   ;
\draw  [fill={rgb, 255:red, 248; green, 231; blue, 28 }  ,fill opacity=0.3 ]  (405, 192.5) rectangle (492.5, 215.5)   ;
\draw    (397.5,204) -- (404,204) ;


\draw    (188.8,203.2) -- (265,203) ;


\draw    (189.5,174) -- (189.8,203.2) ;


\draw    (131.5,174) -- (189.5,174) ;


\draw  [fill={rgb, 255:red, 248; green, 231; blue, 28 }  ,fill opacity=0.3 ]  (220, 293) rectangle (279.5, 333)   ;
\draw  [fill={rgb, 255:red, 248; green, 231; blue, 28 }  ,fill opacity=0.3 ]  (286.5, 293) rectangle (346, 333)   ;
\draw  [fill={rgb, 255:red, 248; green, 231; blue, 28 }  ,fill opacity=0.3 ]  (352, 293) rectangle (411.5, 333)   ;
\draw  [fill={rgb, 255:red, 248; green, 231; blue, 28 }  ,fill opacity=0.3 ]  (416, 293) rectangle (475.5, 333)   ;
\draw    (249.5,342) -- (249.75,333) ;


\draw    (315.5,342) -- (315.75,333) ;


\draw    (380.5,342) -- (380.75,333) ;


\draw    (445.5,342) -- (445.75,333) ;


\draw  [fill={rgb, 255:red, 248; green, 231; blue, 28 }  ,fill opacity=0.3 ]  (221, 411) rectangle (476.5, 452)   ;
\draw    (83.5,204) -- (83.5,233) ;


\draw    (348.5,411) -- (348.75,403) ;


\draw    (265,508) -- (265,542) ;
\draw [shift={(265,542)}, rotate = 270] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ] [draw opacity=0] (8.93,-4.29) -- (0,0) -- (8.93,4.29) -- (8.93,-4.29)    ;

\draw  [fill={rgb, 255:red, 248; green, 231; blue, 28 }  ,fill opacity=0.3 ] (279.85,8) -- (370.5,8) -- (331.65,48) -- (241,48) -- cycle ;
\draw    (350.5,29) -- (357,29) ;


\draw  [dash pattern={on 0.84pt off 2.51pt}]  (113.5,28) -- (261,28) ;

\draw [shift={(113.5,28)}, rotate = 0] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ] [draw opacity=0] (8.93,-4.29) -- (0,0) -- (8.93,4.29) -- (8.93,-4.29)    ;
\draw  [fill={rgb, 255:red, 248; green, 231; blue, 28 }  ,fill opacity=0.3 ] (377.85,7) -- (468.5,7) -- (429.65,47) -- (339,47) -- cycle ;
\draw    (83.5,272) -- (83.5,292) ;
\draw [shift={(83.5,292)}, rotate = 270] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ] [draw opacity=0] (8.93,-4.29) -- (0,0) -- (8.93,4.29) -- (8.93,-4.29)    ;

\draw  [dash pattern={on 0.84pt off 2.51pt}]  (336.5,147) -- (388.5,146) ;


\draw  [dash pattern={on 0.84pt off 2.51pt}]  (387.5,146) -- (387.5,170) ;
\draw [shift={(387.5,170)}, rotate = 270] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ] [draw opacity=0] (8.93,-4.29) -- (0,0) -- (8.93,4.29) -- (8.93,-4.29)    ;


\draw  [fill={rgb, 255:red, 208; green, 2; blue, 27 }  ,fill opacity=0.2 ]   (55.34, 4) rectangle (112.66, 46)   ;
\draw (84,25) node [scale=0.9]  {$ \begin{gathered}
\mathbf{Input:}\\
\mathbf{Data}
\end{gathered}$};
\draw (85,97) node [scale=0.8]  {$ \begin{gathered}
\mathbf{Imputation}\\
\mathbf{( EM\ \&\ CART)}
\end{gathered}$};
\draw (84,175) node [scale=0.8]  {$ \begin{gathered}
\mathbf{Dimention}\\
\mathbf{Reduction}\\
\mathbf{( PCA)}
\end{gathered}$};
\draw (81,313) node [scale=0.7]  {$ \begin{gathered}
\mathbf{Hierarchical\ }\\
\mathbf{Clustering}
\end{gathered}$};
\draw (82,364) node [scale=0.7]  {$\mathbf{k-Means}$};
\draw (82,420) node [scale=0.7]  {$ \begin{gathered}
\mathbf{Expectation}\\
\mathbf{Maximization}
\end{gathered}$};
\draw (84,255) node [scale=0.7]  {$ \begin{gathered}
\mathbf{Cluster\ Analysis}\\
\mathbf{( unsupervised\ learning)}
\end{gathered}$};
\draw  [fill={rgb, 255:red, 248; green, 231; blue, 28 }  ,fill opacity=0.3 ]   (220.16, 482) rectangle (311.84, 508)   ;
\draw (266,495) node   {$\mathbf{Evaluation}$};
\draw (249,312) node [scale=0.7]  {$\mathbf{k-NN}$};
\draw (315,312) node [scale=0.7]  {$\mathbf{SVM}$};
\draw (382,313) node [scale=0.7]  {$ \begin{gathered}
\mathbf{Random}\\
\mathbf{Forest}
\end{gathered}$};
\draw (446,312) node [scale=0.7]  {$\mathbf{LASSO}$};
\draw (349,431) node [scale=0.8]  {$ \begin{gathered}
\mathbf{Validation}\\
\mathbf{(} k\mathbf{-fold} ,\ \mathbf{LOOCV)}
\end{gathered}$};
\draw (349,252) node [scale=0.7]  {$ \begin{gathered}
\mathbf{Classification}\\
\mathbf{( supervised\ learning)}
\end{gathered}$};
\draw (349,370) node   {$\mathbf{Train\ Algorithms}$};
\draw  [fill={rgb, 255:red, 139; green, 233; blue, 134 }  ,fill opacity=0.8 ]   (150.8, 542) rectangle (373.2, 584)   ;
\draw (262,563) node [scale=0.9]  {$ \begin{gathered}
\mathbf{Output:}\\
\mathbf{Clusters\ \&\ Prediction\ Accuracy}
\end{gathered}$};
\draw (344,203) node [scale=0.8]  {$\mathbf{Re-admission}$};
\draw (447,205) node [scale=0.8]  {$\mathbf{Mortality}$};
\draw (393,179) node [scale=0.8]  {$\mathbf{Labels:}$};
\draw (306,28) node [scale=0.8]  {$ \begin{gathered}
\mathbf{HFmrEF}\\
n=182
\end{gathered}$};
\draw (402,27) node [scale=0.8]  {$ \begin{gathered}
\mathbf{HFpEF}\\
n=193
\end{gathered}$};

\end{tikzpicture}

\caption[Machine learning procedure adopted in the thesis]{\textit{Machine learning procedure adopted in the thesis}}
\label{fig:ML_proc_thesis}
\normalsize
\end{figure}